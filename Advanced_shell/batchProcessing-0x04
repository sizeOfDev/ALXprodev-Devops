#!/bin/bash

pokemon=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

pids=()

trap 'echo "Stopping..."; for pid in "${pids[@]}"; do kill "$pid" 2>/dev/null; done; exit 1' INT

for item in "${pokemon[@]}"; do
  (
    echo "Fetching $item..."
    curl -sf "https://pokeapi.co/api/v2/pokemon/$item" -o "$item.json" &&
    echo "Saved $item.json" ||
    echo "Failed to fetch $item" >&2
  ) &

  pids+=($!)
done

jobs

for pid in "${pids[@]}"; do
  wait "$pid"
done

echo "All downloads complete."
